<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçΩÔ∏è Familien-Wochenessensplaner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }

        .header h1 {
            color: #764ba2;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .week-date {
            color: #764ba2;
            font-weight: bold;
            margin-top: 10px;
            font-size: 1.1em;
        }

        .pizza-indicator {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffd93d 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            margin-top: 15px;
            display: inline-block;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .main-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(118,75,162,0.3);
        }

        .btn-secondary {
            background: white;
            color: #764ba2;
            border: 2px solid #764ba2;
        }

        .btn-secondary:hover {
            background: #f0f0f0;
        }

        .btn-github {
            background: linear-gradient(135deg, #24292e 0%, #0366d6 100%);
            color: white;
        }

        .btn-github:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(3,102,214,0.3);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: white;
            padding: 10px;
            border-radius: 10px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 20px;
            background: #f8f8f8;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .tab-content.active {
            display: block;
        }

        .week-overview {
            display: grid;
            gap: 15px;
        }

        .day-card {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid #764ba2;
            transition: all 0.3s;
            position: relative;
        }

        .day-card.pizza-day {
            background: linear-gradient(135deg, #fff5f5 0%, #ffeaa7 100%);
            border-left: 5px solid #ff6b6b;
        }
        
        .day-card .swap-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .day-card .swap-btn:hover {
            background: #764ba2;
            transform: rotate(180deg);
        }

        .day-card:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .day-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #764ba2;
        }

        .price-tag {
            background: #4CAF50;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }

        .meal-info {
            margin: 10px 0;
        }

        .meal-name {
            font-weight: 600;
            color: #333;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .meal-details {
            color: #666;
            font-size: 0.9em;
        }

        .shopping-list {
            columns: 2;
            column-gap: 30px;
        }

        .shopping-category {
            break-inside: avoid;
            background: #f9f9f9;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .shopping-category h3 {
            color: #764ba2;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .shopping-item {
            display: flex;
            align-items: center;
            padding: 5px 0;
        }

        .shopping-item input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .recipe-details {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .recipe-details h3 {
            color: #764ba2;
            margin-bottom: 15px;
        }

        .ingredients-list {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .ingredients-list ul {
            list-style-type: none;
            padding-left: 0;
        }

        .ingredients-list li {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }

        .ingredients-list li:last-child {
            border-bottom: none;
        }

        .instructions {
            background: white;
            padding: 15px;
            border-radius: 8px;
        }

        .instructions ol {
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 10px;
            line-height: 1.8;
        }

        .tips-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
        }

        .tips-box h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .setting-group {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
        }

        .setting-group h3 {
            color: #764ba2;
            margin-bottom: 15px;
        }

        .setting-group label {
            display: block;
            margin-bottom: 10px;
            color: #666;
        }

        .setting-group input[type="number"],
        .setting-group select,
        .setting-group input[type="password"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-top: 5px;
        }

        .setting-group input[type="checkbox"] {
            margin-right: 8px;
        }

        .filter-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .budget-display {
            font-size: 1.2em;
            color: #4CAF50;
            font-weight: bold;
            text-align: center;
            padding: 15px;
            background: #f0fff4;
            border-radius: 10px;
            margin: 20px 0;
        }

        .stats-box {
            background: #e8f4f8;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .stats-box h3 {
            color: #2196F3;
            margin-bottom: 10px;
        }

        .saved-weeks-list {
            display: grid;
            gap: 10px;
            margin-top: 15px;
        }

        .saved-week-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        .saved-week-info {
            flex: 1;
        }

        .saved-week-date {
            font-weight: bold;
            color: #764ba2;
            font-size: 1.1em;
        }

        .saved-week-summary {
            font-size: 0.95em;
            color: #666;
            margin-top: 5px;
        }

        .saved-week-actions {
            display: flex;
            gap: 8px;
        }

        .mini-btn {
            padding: 8px 15px;
            font-size: 0.95em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .mini-btn-load {
            background: #4CAF50;
            color: white;
        }

        .mini-btn-load:hover {
            background: #45a049;
            transform: translateY(-1px);
        }

        .mini-btn-delete {
            background: #f44336;
            color: white;
        }

        .mini-btn-delete:hover {
            background: #da190b;
            transform: translateY(-1px);
        }

        .confirm-dialog {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 2000;
            max-width: 450px;
            display: none;
        }

        .confirm-dialog.active {
            display: block;
        }

        .confirm-dialog h3 {
            color: #764ba2;
            margin-bottom: 15px;
        }

        .confirm-dialog p {
            margin-bottom: 15px;
            color: #666;
            line-height: 1.5;
        }

        .confirm-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            color: #764ba2;
            margin: 0;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .close-modal:hover {
            color: #333;
        }

        .github-section {
            margin-bottom: 25px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
        }

        .github-section h3 {
            color: #24292e;
            margin-bottom: 15px;
        }

        .github-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: monospace;
            margin: 10px 0;
        }

        .github-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .github-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            flex: 1;
            min-width: 120px;
        }

        .github-btn-primary {
            background: #24292e;
            color: white;
        }

        .github-btn-primary:hover {
            background: #0366d6;
            transform: translateY(-2px);
        }

        .github-btn-secondary {
            background: white;
            color: #24292e;
            border: 2px solid #24292e;
        }

        .github-btn-secondary:hover {
            background: #f6f8fa;
        }

        .status-message {
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            text-align: center;
            font-weight: bold;
        }

        .status-success {
            color: #4CAF50;
            background: #f0fff4;
        }

        .status-error {
            color: #f44336;
            background: #ffebee;
        }

        .status-info {
            color: #2196F3;
            background: #e3f2fd;
        }

        .gist-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-top: 10px;
        }

        .gist-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.3s;
        }

        .gist-item:hover {
            background: #f6f8fa;
        }

        .gist-item:last-child {
            border-bottom: none;
        }

        .gist-title {
            font-weight: bold;
            color: #24292e;
        }

        .gist-date {
            font-size: 0.9em;
            color: #666;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 50px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #764ba2;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @media (max-width: 768px) {
            .shopping-list {
                columns: 1;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .main-controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .filter-group {
                grid-template-columns: 1fr;
            }
        }

        @media print {
            body {
                background: white;
            }
            
            .btn, .tabs, .main-controls, .swap-btn {
                display: none !important;
            }
            
            .tab-content {
                display: block !important;
                box-shadow: none;
                border: 1px solid #ddd;
                margin-bottom: 30px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üçΩÔ∏è Familien-Wochenessensplaner</h1>
            <p>Intelligente Wochenplanung f√ºr 2 Erwachsene und 2 Kleinkinder</p>
            <p>Budget: <span id="budgetDisplay">175 CHF</span> pro Woche (25 CHF/Tag)</p>
            <p class="week-date" id="weekDateDisplay">Woche vom ... bis ...</p>
            <div id="pizzaIndicator" style="display:none;">
                <span class="pizza-indicator">üçï Pizza-Wochenende! üçï</span>
            </div>
        </div>

        <div class="stats-box">
            <h3>üìö Rezept-Datenbank</h3>
            <p><strong id="totalRecipes">0</strong> Rezepte verf√ºgbar | <strong id="meatCount">0</strong> Fleisch | <strong id="vegCount">0</strong> Vegetarisch | <strong id="kidsCount">0</strong> Kinder</p>
            <p style="margin-top: 10px; font-size: 0.9em; color: #666;">
                N√§chstes Pizza-Wochenende in <strong id="pizzaCountdown">...</strong> Woche(n)
            </p>
        </div>

        <div class="main-controls">
            <button class="btn btn-primary" onclick="confirmGenerateNewPlan()">
                üé≤ Neuen Plan generieren
            </button>
            <button class="btn btn-secondary" onclick="saveCurrentWeek()">
                üíæ Woche speichern
            </button>
            <button class="btn btn-secondary" onclick="showSavedWeeks()">
                üìÇ Gespeicherte Wochen
            </button>
            <button class="btn btn-secondary" onclick="exportToPDF()">
                üìÑ Als PDF exportieren
            </button>
            <button class="btn btn-github" onclick="showGitHubSync()">
                <svg style="width: 20px; height: 20px; vertical-align: middle; margin-right: 5px;" fill="white" viewBox="0 0 16 16">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
                GitHub Sync
            </button>
            <button class="btn btn-secondary" onclick="savePreferences()">
                ‚öôÔ∏è Einstellungen speichern
            </button>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab(event, 'overview')">üìÖ Wochen√ºbersicht</button>
            <button class="tab" onclick="switchTab(event, 'shopping')">üõí Einkaufsliste</button>
            <button class="tab" onclick="switchTab(event, 'recipes')">üìñ Rezepte</button>
            <button class="tab" onclick="switchTab(event, 'settings')">‚öôÔ∏è Einstellungen</button>
        </div>

        <div id="overview" class="tab-content active">
            <div class="loading" id="loadingOverview">
                <div class="spinner"></div>
                <p>Generiere Wochenplan...</p>
            </div>
            <div class="week-overview" id="weekOverview"></div>
            <div class="budget-display">
                Gesamtkosten der Woche: <span id="totalCost">0</span> CHF
            </div>
        </div>

        <div id="shopping" class="tab-content">
            <h2>üõí Einkaufsliste</h2>
            <div class="shopping-list" id="shoppingList"></div>
        </div>

        <div id="recipes" class="tab-content">
            <h2>üìñ Detaillierte Rezepte</h2>
            <div id="recipesList"></div>
        </div>

        <div id="settings" class="tab-content">
            <h2>‚öôÔ∏è Einstellungen</h2>
            <div class="settings-grid">
                <div class="setting-group">
                    <h3>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Familie</h3>
                    <label>
                        Anzahl Erwachsene:
                        <input type="number" id="adultsCount" value="2" min="1" max="4" onchange="updateBudgetDisplay()">
                    </label>
                    <label>
                        Anzahl Kinder:
                        <input type="number" id="childrenCount" value="2" min="0" max="6" onchange="updateBudgetDisplay()">
                    </label>
                </div>
                
                <div class="setting-group">
                    <h3>üí∞ Budget</h3>
                    <label>
                        Tagesbudget (CHF):
                        <input type="number" id="dailyBudget" value="25" min="10" max="50" onchange="updateBudgetDisplay()">
                    </label>
                </div>
                
                <div class="setting-group">
                    <h3>ü•ó Ern√§hrung</h3>
                    <label>
                        Vegetarische Tage pro Woche:
                        <input type="number" id="vegDays" value="3" min="0" max="7">
                    </label>
                    <label>
                        Pizza-Wochenende alle:
                        <select id="pizzaFrequency">
                            <option value="2">2 Wochen</option>
                            <option value="3" selected>2-3 Wochen (Zufall)</option>
                            <option value="4">3-4 Wochen</option>
                            <option value="0">Nie</option>
                        </select>
                    </label>
                </div>

                <div class="setting-group">
                    <h3>üö´ Ausschl√ºsse - Fleisch</h3>
                    <div class="filter-group">
                        <label>
                            <input type="checkbox" id="noLamb"> Kein Lamm
                        </label>
                        <label>
                            <input type="checkbox" id="noPork"> Kein Schwein
                        </label>
                        <label>
                            <input type="checkbox" id="noBeef"> Kein Rind
                        </label>
                        <label>
                            <input type="checkbox" id="noDuck"> Keine Ente
                        </label>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>üßÄ Ausschl√ºsse - Milchprodukte</h3>
                    <div class="filter-group">
                        <label>
                            <input type="checkbox" id="noCottageCheese"> Kein H√ºttenk√§se
                        </label>
                        <label>
                            <input type="checkbox" id="noGorgonzola"> Kein Gorgonzola
                        </label>
                        <label>
                            <input type="checkbox" id="noFeta"> Kein Feta
                        </label>
                        <label>
                            <input type="checkbox" id="noCheese"> Kein nicht-√ºberbackener K√§se
                        </label>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>ü•ò Weitere Ausschl√ºsse</h3>
                    <div class="filter-group">
                        <label>
                            <input type="checkbox" id="noFish"> Keine Fischgerichte
                        </label>
                        <label>
                            <input type="checkbox" id="noMushrooms"> Keine Pilze
                        </label>
                        <label>
                            <input type="checkbox" id="noNuts"> Keine N√ºsse
                        </label>
                        <label>
                            <input type="checkbox" id="noSpicy"> Nicht scharf
                        </label>
                        <label>
                            <input type="checkbox" id="noTofu"> Kein Tofu
                        </label>
                        <label>
                            <input type="checkbox" id="noEggplant"> Keine Aubergine
                        </label>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>üîê GitHub Token</h3>
                    <label>
                        GitHub Personal Access Token:
                        <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxx">
                    </label>
                    <p style="font-size: 0.9em; color: #666; margin-top: 5px;">
                        F√ºr GitHub Sync. Token erstellen: 
                        <a href="https://github.com/settings/tokens/new" target="_blank" style="color: #0366d6;">
                            GitHub Settings ‚Üí Tokens
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- GitHub Sync Modal -->
    <div id="githubModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîÑ GitHub Synchronisation</h2>
                <button class="close-modal" onclick="closeGitHubSync()">√ó</button>
            </div>
            
            <div class="github-section">
                <h3>üì§ Wochenplan auf GitHub speichern</h3>
                <p>Speichere deinen aktuellen Wochenplan als Gist auf GitHub:</p>
                <input type="text" class="github-input" id="gistName" placeholder="Name f√ºr den Gist (optional)">
                <div class="github-actions">
                    <button class="github-btn github-btn-primary" onclick="saveToGitHub()">
                        üì§ Als Gist speichern
                    </button>
                    <button class="github-btn github-btn-secondary" onclick="updateExistingGist()">
                        üîÑ Bestehenden Gist aktualisieren
                    </button>
                </div>
                <div id="saveStatus"></div>
            </div>
            
            <div class="github-section">
                <h3>üì• Wochenplan von GitHub laden</h3>
                <p>Lade einen gespeicherten Wochenplan von GitHub:</p>
                <button class="github-btn github-btn-primary" onclick="loadGists()">
                    üìã Meine Gists anzeigen
                </button>
                <div id="gistList" class="gist-list" style="display:none;"></div>
                
                <p style="margin-top: 15px;">Oder gib eine Gist-ID direkt ein:</p>
                <input type="text" class="github-input" id="gistId" placeholder="Gist ID oder URL">
                <button class="github-btn github-btn-secondary" onclick="loadFromGitHub()">
                    üì• Von Gist laden
                </button>
                <div id="loadStatus"></div>
            </div>

            <div class="github-section">
                <h3>‚ÑπÔ∏è Anleitung</h3>
                <ol style="color: #666; font-size: 0.95em; line-height: 1.8;">
                    <li>Erstelle einen GitHub Personal Access Token mit "gist" Berechtigung</li>
                    <li>F√ºge den Token in den Einstellungen ein</li>
                    <li>Speichere deine Wochenpl√§ne als private Gists</li>
                    <li>Teile Gist-URLs mit Familie/Freunden zum gemeinsamen Nutzen</li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        // Rezept-Datenbank
        let recipes = {};
        
        // Rezepte laden
        function loadRecipes() {
            recipes = {
                meat: [
                    {name:"Spaghetti Carbonara",category:"Fleisch",price:18,ingredients:{"Spaghetti":"500g","Speck/Pancetta":"200g","Eier":"4 St√ºck","Parmesan":"150g","Knoblauch":"2 Zehen","Schwarzer Pfeffer":"nach Geschmack"},instructions:["Wasser f√ºr Nudeln aufsetzen und salzen","Speck in kleine W√ºrfel schneiden und knusprig braten","Spaghetti al dente kochen","Eier mit Parmesan verquirlen","Nudeln zum Speck geben, vom Herd nehmen","Ei-K√§se-Mischung unterr√ºhren"],childTip:"F√ºr Kinder weniger Pfeffer verwenden",workTip:"L√§sst sich gut erw√§rmen"},
                    {name:"H√§hnchenbrust mit R√∂sti",category:"Fleisch",price:22,ingredients:{"H√§hnchenbrust":"600g","Kartoffeln":"800g","Gr√ºne Bohnen":"400g","Butter":"50g","Zwiebel":"1 St√ºck"},instructions:["Kartoffeln raspeln und ausdr√ºcken","H√§hnchen w√ºrzen und braten","R√∂sti goldbraun braten","Bohnen bissfest kochen","Alles zusammen anrichten"],childTip:"H√§hnchen in kleine St√ºcke schneiden",workTip:"R√∂sti werden beim Erw√§rmen wieder knusprig"},
                    {name:"Rindergulasch mit Sp√§tzle",category:"Fleisch",price:28,ingredients:{"Rindergulasch":"700g","Sp√§tzle":"500g","Zwiebeln":"3 gro√üe","Paprika":"2 St√ºck","Tomatenmark":"3 EL","Paprikapulver":"2 EL"},instructions:["Fleisch scharf anbraten","Zwiebeln und Paprika zugeben","Mit Fond abl√∂schen","1,5 Std k√∂cheln lassen","Sp√§tzle kochen","Mit Sp√§tzle servieren"],childTip:"Weniger Paprika f√ºr Kinder",workTip:"Wird beim Erw√§rmen noch besser"},
                    {name:"Schweinemedaillons mit Champignonsauce",category:"Fleisch",price:26,ingredients:{"Schweinefilet":"600g","Champignons":"400g","Sahne":"250ml","Kartoffeln":"1kg","Brokkoli":"500g"},instructions:["Medaillons braten","Champignons anbraten","Mit Sahne abl√∂schen","Kartoffeln kochen","Brokkoli d√§mpfen","Zusammen servieren"],childTip:"Sauce separat servieren",workTip:"Fleisch und Sauce getrennt erw√§rmen"},
                    {name:"Hackfleisch-Kartoffel-Auflauf",category:"Fleisch",price:20,ingredients:{"Hackfleisch":"500g","Kartoffeln":"1kg","Zwiebeln":"2 St√ºck","K√§se":"200g","Milch":"300ml"},instructions:["Kartoffeln in Scheiben schneiden","Hackfleisch anbraten","Schichten und √ºberbacken","45 Min bei 180¬∞C backen"],childTip:"Perfekt f√ºr Kinder",workTip:"Portionsweise einfrieren m√∂glich"},
                    {name:"H√§hnchen-Curry",category:"Fleisch",price:24,ingredients:{"H√§hnchenbrust":"600g","Kokosmilch":"400ml","Currypaste":"2 EL","Reis":"400g","Gem√ºse":"400g"},instructions:["H√§hnchen anbraten","Currypaste einr√ºhren","Mit Kokosmilch abl√∂schen","Gem√ºse zugeben","Mit Reis servieren"],childTip:"Sehr milde Currypaste verwenden",workTip:"Curry schmeckt aufgew√§rmt noch besser"},
                    {name:"Bolognese mit Penne",category:"Fleisch",price:19,ingredients:{"Rinderhack":"500g","Penne":"500g","Dosentomaten":"800g","Zwiebeln":"2 St√ºck","M√∂hren":"2 St√ºck"},instructions:["Gem√ºse w√ºrfeln und anschwitzen","Hackfleisch kr√ºmelig braten","Tomaten zugeben","2 Stunden k√∂cheln","Penne kochen","Mit Parmesan servieren"],childTip:"Gem√ºse sehr fein hacken",workTip:"Sauce einfrieren, Nudeln frisch"},
                    {name:"Gyros mit Tzatziki",category:"Fleisch",price:25,ingredients:{"Schweinefleisch":"700g","Pita":"6 St√ºck","Joghurt":"300g","Gurke":"1 St√ºck","Pommes":"500g"},instructions:["Fleisch marinieren und braten","Tzatziki zubereiten","Pommes backen","Pita erw√§rmen","Alles zusammen servieren"],childTip:"Weniger Knoblauch",workTip:"Komponenten getrennt transportieren"},
                    {name:"Chili con Carne",category:"Fleisch",price:21,ingredients:{"Rinderhack":"600g","Kidneybohnen":"2 Dosen","Mais":"1 Dose","Paprika":"2 St√ºck","Reis":"400g"},instructions:["Hackfleisch anbraten","Gem√ºse zugeben","Bohnen und Mais einr√ºhren","1 Stunde k√∂cheln","Mit Reis servieren"],childTip:"Sehr mild w√ºrzen",workTip:"Perfekt zum Einfrieren"},
                    {name:"Schnitzel mit Kartoffelsalat",category:"Fleisch",price:25,ingredients:{"Schnitzel":"600g","Paniermehl":"200g","Kartoffeln":"1kg","Mayonnaise":"150g","Gurken":"3 kleine"},instructions:["Kartoffelsalat vorbereiten","Schnitzel panieren","Goldbraun braten","Zusammen servieren"],childTip:"Schnitzel in Streifen schneiden",workTip:"Kalt auch lecker"},
                    {name:"Geschnetzeltes Z√ºrcher Art",category:"Fleisch",price:30,ingredients:{"Kalbfleisch":"600g","Champignons":"300g","Sahne":"250ml","R√∂sti":"800g Kartoffeln","Wei√üwein":"150ml"},instructions:["Fleisch in Streifen schneiden","Scharf anbraten","Pilze zugeben","Mit Wein und Sahne abl√∂schen","R√∂sti zubereiten"],childTip:"Weniger Wein verwenden",workTip:"Gut erw√§rmbar"},
                    {name:"Shepherd's Pie",category:"Fleisch",price:20,ingredients:{"Lammhack":"600g","Kartoffeln":"1,2kg","Erbsen":"200g","M√∂hren":"3 St√ºck","Tomatenmark":"2 EL"},instructions:["Kartoffelp√ºree vorbereiten","Hackfleisch mit Gem√ºse anbraten","In Form schichten","30 Min √ºberbacken"],childTip:"Kinder lieben die Kartoffelhaube",workTip:"Portionsweise einfrieren"},
                    {name:"Asia-Hackfleischpfanne",category:"Fleisch",price:18,ingredients:{"Hackfleisch":"500g","Glasnudeln":"200g","Chinakohl":"1 kleiner","Sojasauce":"4 EL","Ingwer":"1 St√ºck"},instructions:["Glasnudeln einweichen","Hackfleisch anbraten","Gem√ºse zugeben","Nudeln untermischen","Mit Sojasauce w√ºrzen"],childTip:"Weniger Ingwer",workTip:"Schnell erw√§rmt"},
                    {name:"H√§hnchen-Fajitas",category:"Fleisch",price:23,ingredients:{"H√§hnchen":"600g","Tortillas":"8 St√ºck","Paprika":"3 St√ºck","Zwiebeln":"2 gro√üe","Fajita-Gew√ºrz":"2 EL"},instructions:["H√§hnchen marinieren","Mit Gem√ºse anbraten","Tortillas erw√§rmen","F√ºllen und servieren"],childTip:"Weniger Gew√ºrz",workTip:"F√ºllung separat transportieren"},
                    {name:"K√∂nigsberger Klopse",category:"Fleisch",price:22,ingredients:{"Hackfleisch":"500g","Kapern":"3 EL","Sahne":"200ml","Kartoffeln":"1kg","Mehl":"2 EL"},instructions:["Klopse formen","In Br√ºhe garziehen","Sauce mit Mehlschwitze","Kartoffeln kochen","Zusammen servieren"],childTip:"Ohne Kapern f√ºr Kinder",workTip:"In Sauce transportieren"},
                    {name:"Pulled Pork Burger",category:"Fleisch",price:27,ingredients:{"Schweineschulter":"800g","BBQ-Sauce":"200ml","Burger-Br√∂tchen":"8 St√ºck","Krautsalat":"400g","Pommes":"600g"},instructions:["Schwein 4-5 Std bei 120¬∞C garen","Fleisch zerzupfen","Mit BBQ-Sauce mischen","Burger zusammenbauen"],childTip:"Milde BBQ-Sauce",workTip:"Super aufw√§rmbar"},
                    {name:"Moussaka",category:"Fleisch",price:24,ingredients:{"Lammhack":"600g","Auberginen":"2 gro√üe","Kartoffeln":"500g","Bechamel":"500ml","Tomaten":"400g"},instructions:["Gem√ºse in Scheiben schneiden","Hackfleisch anbraten","Schichten in Form","Mit Bechamel √ºbergie√üen","45 Min backen"],childTip:"Ohne Zimt f√ºr Kinder",workTip:"Aufgew√§rmt noch besser"},
                    {name:"Thai-Rindfleisch",category:"Fleisch",price:26,ingredients:{"Rindfleisch":"600g","Thai-Basilikum":"2 Bund","Reis":"400g","Sojasauce":"4 EL","Chili":"1 St√ºck"},instructions:["Fleisch in Streifen schneiden","Im Wok anbraten","Basilikum unterheben","Mit Sojasauce w√ºrzen","Mit Reis servieren"],childTip:"Ohne Chili",workTip:"Schnell aufgew√§rmt"},
                    {name:"Burritos",category:"Fleisch",price:22,ingredients:{"Rinderhack":"500g","Tortillas":"6 gro√üe","Reis":"300g","Bohnen":"1 Dose","K√§se":"200g"},instructions:["Reis kochen","Hackfleisch anbraten","Bohnen erw√§rmen","Tortillas f√ºllen","Einrollen"],childTip:"Milde W√ºrzung",workTip:"In Alufolie gut transportierbar"},
                    {name:"Cordon Bleu",category:"Fleisch",price:29,ingredients:{"Schnitzel":"4 St√ºck","Schinken":"100g","K√§se":"100g","Paniermehl":"200g","Salat":"300g"},instructions:["Schnitzel f√ºllen","Panieren","Goldbraun braten","Mit Salat servieren"],childTip:"In Streifen schneiden",workTip:"Kalt auch lecker"},
                    {name:"Lammkoteletts mit Couscous",category:"Fleisch",price:32,ingredients:{"Lammkoteletts":"8 St√ºck","Couscous":"400g","Minze":"1 Bund","Granatapfel":"1 St√ºck","Joghurt":"200g"},instructions:["Lammkoteletts marinieren","Scharf anbraten","Couscous zubereiten","Mit Minz-Joghurt servieren"],childTip:"Milder w√ºrzen",workTip:"Kalt als Salat"},
                    {name:"Entenbrust mit Rotkohl",category:"Fleisch",price:35,ingredients:{"Entenbrust":"2 St√ºck","Rotkohl":"1 Kopf","√Ñpfel":"2 St√ºck","Kartoffelkl√∂√üe":"8 St√ºck","Preiselbeeren":"100g"},instructions:["Entenbrust einschneiden","Rosa braten","Rotkohl schmoren","Kl√∂√üe kochen","Mit Preiselbeeren servieren"],childTip:"H√§hnchen als Alternative",workTip:"Festtagsessen"},
                    {name:"Hackbraten mit Kartoffelp√ºree",category:"Fleisch",price:19,ingredients:{"Hackfleisch":"700g","Ei":"2 St√ºck","Semmelbr√∂sel":"100g","Kartoffeln":"1,2kg","Erbsen":"300g"},instructions:["Hackbraten formen","60 Min backen","Kartoffelp√ºree zubereiten","Erbsen kochen","In Scheiben servieren"],childTip:"Kinder-Liebling",workTip:"Kalt als Sandwich"},
                    {name:"Wiener Schnitzel",category:"Fleisch",price:28,ingredients:{"Kalbsschnitzel":"4 St√ºck","Eier":"3 St√ºck","Semmelbr√∂sel":"200g","Kartoffelsalat":"1kg","Preiselbeeren":"100g"},instructions:["Schnitzel klopfen","Klassisch panieren","In Butterschmalz braten","Mit Kartoffelsalat servieren"],childTip:"Der Klassiker",workTip:"Kalt im Br√∂tchen"},
                    {name:"Sauerbraten",category:"Fleisch",price:30,ingredients:{"Rinderbraten":"1kg","Rotwein":"500ml","Lebkuchen":"2 St√ºck","Kartoffelkl√∂√üe":"8 St√ºck","Rotkohl":"1 Kopf"},instructions:["Fleisch 3 Tage marinieren","Scharf anbraten","2 Std schmoren","Sauce mit Lebkuchen binden","Mit Kl√∂√üen servieren"],childTip:"Ohne Alkohol zubereiten",workTip:"Wird besser beim Aufw√§rmen"},
                    {name:"Kalbsragout",category:"Fleisch",price:31,ingredients:{"Kalbfleisch":"700g","Champignons":"300g","Sahne":"300ml","Reis":"400g","M√∂hren":"3 St√ºck"},instructions:["Kalbfleisch w√ºrfeln","Anbraten","Gem√ºse zugeben","Mit Sahne abl√∂schen","Mit Reis servieren"],childTip:"Sehr mild",workTip:"Gut aufw√§rmbar"},
                    {name:"Rouladen",category:"Fleisch",price:27,ingredients:{"Rinderrouladen":"4 St√ºck","Speck":"100g","Gurken":"4 kleine","Senf":"4 EL","Kartoffeln":"1kg"},instructions:["Rouladen f√ºllen","Anbraten","90 Min schmoren","Sauce einkochen","Mit Kartoffeln servieren"],childTip:"Sauce extra",workTip:"Klassiker zum Aufw√§rmen"},
                    {name:"Leberk√§se mit Spiegelei",category:"Fleisch",price:16,ingredients:{"Leberk√§se":"600g","Eier":"4 St√ºck","Kartoffelsalat":"800g","Senf":"nach Geschmack"},instructions:["Leberk√§se braten","Spiegeleier braten","Kartoffelsalat anrichten","Zusammen servieren"],childTip:"Ohne Spiegelei",workTip:"Bayerischer Klassiker"},
                    {name:"Putenschnitzel Hawaii",category:"Fleisch",price:24,ingredients:{"Putenschnitzel":"4 St√ºck","Ananas":"4 Scheiben","Schinken":"4 Scheiben","K√§se":"200g","Reis":"400g"},instructions:["Schnitzel braten","Mit Schinken und Ananas belegen","Mit K√§se √ºberbacken","Mit Reis servieren"],childTip:"S√º√ü-herzhaft beliebt",workTip:"Auch kalt lecker"},
                    {name:"Rindersteaks mit Ofengem√ºse",category:"Fleisch",price:33,ingredients:{"Rindersteaks":"4 St√ºck","Kartoffeln":"800g","Paprika":"2 St√ºck","Zucchini":"2 St√ºck","Kr√§uterbutter":"100g"},instructions:["Gem√ºse schneiden und w√ºrzen","Im Ofen r√∂sten","Steaks medium braten","Mit Kr√§uterbutter servieren"],childTip:"Steaks durchbraten f√ºr Kinder",workTip:"Kalt als Salat"}
                ],
                vegetarian: [
                    {name:"Gem√ºse-Lasagne",category:"Vegetarisch",price:16,ingredients:{"Lasagneplatten":"250g","Zucchini":"2 St√ºck","Aubergine":"1 St√ºck","Tomaten":"800g","Mozzarella":"250g"},instructions:["Gem√ºse in Scheiben schneiden","Anbraten und w√ºrzen","Lasagne schichten","45 Min backen"],childTip:"Viel K√§se macht es lecker",workTip:"Perfekt zum Aufw√§rmen"},
                    {name:"K√§sesp√§tzle",category:"Vegetarisch",price:14,ingredients:{"Sp√§tzle":"600g","Emmentaler":"300g","Zwiebeln":"3 gro√üe","Butter":"50g","Salat":"1 Kopf"},instructions:["Sp√§tzle kochen","Zwiebeln r√∂sten","Mit K√§se schichten","√úberbacken","Mit Salat servieren"],childTip:"Kinder-Lieblingsgericht",workTip:"Mit Milch aufw√§rmen"},
                    {name:"Gem√ºse-Curry",category:"Vegetarisch",price:15,ingredients:{"Kichererbsen":"2 Dosen","Kokosmilch":"400ml","Gem√ºse":"600g","Currypaste":"2 EL","Reis":"400g"},instructions:["Gem√ºse w√ºrfeln","Currypaste anr√∂sten","Gem√ºse zugeben","Mit Kokosmilch abl√∂schen","Mit Reis servieren"],childTip:"Sehr mild w√ºrzen",workTip:"Wird aufgew√§rmt aromatischer"},
                    {name:"Pizza Margherita",category:"Vegetarisch",price:12,ingredients:{"Pizzateig":"500g","Tomatensauce":"200ml","Mozzarella":"250g","Basilikum":"1 Bund","Oliven√∂l":"3 EL"},instructions:["Teig ausrollen","Mit Sauce bestreichen","Mozzarella verteilen","15 Min bei 220¬∞C backen","Mit Basilikum garnieren"],childTip:"Der Klassiker",workTip:"Kalt als Pizza-Schnitte"},
                    {name:"Risotto mit Pilzen",category:"Vegetarisch",price:18,ingredients:{"Risottoreis":"400g","Pilze":"400g","Wei√üwein":"200ml","Parmesan":"150g","Br√ºhe":"1,5L"},instructions:["Pilze anbraten","Reis anschwitzen","Nach und nach Br√ºhe zugeben","St√§ndig r√ºhren","Mit Parmesan verfeinern"],childTip:"Weniger Wei√üwein",workTip:"Mit Br√ºhe aufw√§rmen"},
                    {name:"Quesadillas",category:"Vegetarisch",price:13,ingredients:{"Tortillas":"8 St√ºck","Bohnen":"1 Dose","Mais":"1 Dose","K√§se":"300g","Paprika":"2 St√ºck"},instructions:["Bohnen zerdr√ºcken","Gem√ºse anbraten","Tortilla belegen","In Pfanne braten","Mit Dips servieren"],childTip:"Milde Salsa",workTip:"Kalt auch lecker"},
                    {name:"Pasta Primavera",category:"Vegetarisch",price:14,ingredients:{"Penne":"500g","Gem√ºse":"600g","Sahne":"200ml","Parmesan":"100g","Knoblauch":"2 Zehen"},instructions:["Nudeln kochen","Gem√ºse anbraten","Mit Sahne abl√∂schen","Nudeln untermischen","Mit Parmesan servieren"],childTip:"Gem√ºse klein schneiden",workTip:"Mit Wasser aufw√§rmen"},
                    {name:"Shakshuka",category:"Vegetarisch",price:12,ingredients:{"Eier":"6 St√ºck","Tomaten":"800g","Paprika":"2 St√ºck","Feta":"150g","Fladenbrot":"4 St√ºck"},instructions:["Gem√ºse anbraten","Tomaten zugeben","Mulden formen","Eier hineinschlagen","Stocken lassen"],childTip:"Eier gut durchgaren",workTip:"Frisch zubereiten"},
                    {name:"Buddha Bowl",category:"Vegetarisch",price:16,ingredients:{"Quinoa":"250g","S√º√ükartoffel":"2 St√ºck","Kichererbsen":"1 Dose","Avocado":"2 St√ºck","Tahini":"3 EL"},instructions:["Quinoa kochen","S√º√ükartoffel r√∂sten","Kichererbsen w√ºrzen","In Bowls anrichten","Mit Tahini-Dressing"],childTip:"Komponenten getrennt",workTip:"Als Meal-Prep perfekt"},
                    {name:"Gnocchi mit Tomatensauce",category:"Vegetarisch",price:15,ingredients:{"Gnocchi":"800g","Tomaten":"800g","Mozzarella":"250g","Basilikum":"1 Bund","Knoblauch":"2 Zehen"},instructions:["Sauce k√∂cheln lassen","Gnocchi kochen","Mit Sauce mischen","Mozzarella unterheben","Mit Basilikum garnieren"],childTip:"Kinder lieben Gnocchi",workTip:"Sehr gut aufw√§rmbar"},
                    {name:"Spinat-Ricotta-Cannelloni",category:"Vegetarisch",price:17,ingredients:{"Cannelloni":"250g","Spinat":"450g","Ricotta":"400g","Tomatensauce":"500ml","Mozzarella":"200g"},instructions:["Spinat auftauen","Mit Ricotta mischen","Cannelloni f√ºllen","Mit Sauce √ºbergie√üen","35 Min backen"],childTip:"Sehr mild und k√§sig",workTip:"Perfekt aufw√§rmbar"},
                    {name:"Falafel-Wrap",category:"Vegetarisch",price:15,ingredients:{"Falafel-Mix":"300g","Wraps":"6 St√ºck","Hummus":"200g","Salat":"200g","Tomaten":"3 St√ºck"},instructions:["Falafel zubereiten","Frittieren oder backen","Wraps belegen","Mit Hummus bestreichen","Einrollen"],childTip:"Falafel klein brechen",workTip:"Komponenten getrennt"},
                    {name:"Gem√ºse-Paella",category:"Vegetarisch",price:18,ingredients:{"Paella-Reis":"400g","Gem√ºse":"800g","Safran":"1 Prise","Br√ºhe":"1L","Zitronen":"2 St√ºck"},instructions:["Gem√ºse anbraten","Reis zugeben","Mit Br√ºhe abl√∂schen","Safran zugeben","Ohne R√ºhren garen"],childTip:"Buntes Reisgericht",workTip:"Kalt als Reissalat"},
                    {name:"Halloumi-Spie√üe",category:"Vegetarisch",price:19,ingredients:{"Halloumi":"400g","Gem√ºse":"600g","Couscous":"300g","Zitronen":"2 St√ºck","Oregano":"2 TL"},instructions:["Halloumi und Gem√ºse w√ºrfeln","Auf Spie√üe stecken","Grillen oder backen","Couscous zubereiten","Zusammen servieren"],childTip:"Halloumi ist mild",workTip:"Kalt auch gut"},
                    {name:"Bauernfr√ºhst√ºck",category:"Vegetarisch",price:11,ingredients:{"Kartoffeln":"1kg","Eier":"6 St√ºck","Zwiebeln":"2 St√ºck","Gurken":"4 St√ºck","Milch":"100ml"},instructions:["Kartoffeln in Scheiben","Anbraten mit Zwiebeln","Eier verquirlen","Dar√ºber gie√üen","Stocken lassen"],childTip:"Comfort Food",workTip:"Auch kalt lecker"},
                    {name:"S√º√ükartoffel-Curry",category:"Vegetarisch",price:14,ingredients:{"S√º√ükartoffeln":"800g","Linsen":"200g","Kokosmilch":"400ml","Spinat":"200g","Naan":"4 St√ºck"},instructions:["S√º√ükartoffeln w√ºrfeln","Mit Linsen k√∂cheln","Kokosmilch zugeben","Spinat unterheben","Mit Naan servieren"],childTip:"S√º√ülich und mild",workTip:"Wird cremiger beim Aufw√§rmen"},
                    {name:"Gem√ºse-Couscous",category:"Vegetarisch",price:14,ingredients:{"Couscous":"400g","Gem√ºse":"600g","Kichererbsen":"1 Dose","Rosinen":"50g","Minze":"1 Bund"},instructions:["Couscous quellen lassen","Gem√ºse anbraten","Mit Couscous mischen","Rosinen zugeben","Mit Minze garnieren"],childTip:"Rosinen machen es s√º√ü",workTip:"Kalt als Salat super"},
                    {name:"Ratatouille",category:"Vegetarisch",price:14,ingredients:{"Aubergine":"1 St√ºck","Zucchini":"2 St√ºck","Paprika":"2 St√ºck","Tomaten":"4 St√ºck","Reis":"400g"},instructions:["Gem√ºse w√ºrfeln","Nacheinander anbraten","30 Min schmoren","Reis kochen","Zusammen servieren"],childTip:"Gem√ºse weich kochen",workTip:"Klassiker zum Aufw√§rmen"},
                    {name:"Linsen-Bolognese",category:"Vegetarisch",price:13,ingredients:{"Rote Linsen":"250g","Spaghetti":"500g","Tomaten":"800g","Gem√ºse":"400g","Parmesan":"100g"},instructions:["Gem√ºse w√ºrfeln","Linsen zugeben","Mit Tomaten k√∂cheln","Spaghetti kochen","Mit Parmesan servieren"],childTip:"Wie echte Bolognese",workTip:"Sauce einfrieren"},
                    {name:"Blumenkohl-Wings",category:"Vegetarisch",price:15,ingredients:{"Blumenkohl":"1 gro√üer","Mehl":"150g","Milch":"200ml","BBQ-Sauce":"200ml","Pommes":"500g"},instructions:["Blumenkohl in R√∂schen","Panieren","Backen","Mit BBQ-Sauce","Mit Pommes servieren"],childTip:"Sieht aus wie Chicken",workTip:"Frisch am besten"},
                    {name:"K√§se-Lauch-Suppe",category:"Vegetarisch",price:13,ingredients:{"Lauch":"3 Stangen","Schmelzk√§se":"400g","Gem√ºsebr√ºhe":"1L","Baguette":"1 St√ºck","Sahne":"200ml"},instructions:["Lauch anbraten","Mit Br√ºhe abl√∂schen","K√§se einr√ºhren","Mit Sahne verfeinern","Mit Baguette servieren"],childTip:"Sehr cremig und mild",workTip:"Perfekt aufw√§rmbar"},
                    {name:"Gem√ºse-Tempura",category:"Vegetarisch",price:16,ingredients:{"Gem√ºse gemischt":"800g","Tempuramehl":"200g","Eiswasser":"300ml","Reis":"400g","Sojasauce":"100ml"},instructions:["Gem√ºse vorbereiten","Tempurateig anr√ºhren","Frittieren","Mit Reis servieren","Sojasauce zum Dippen"],childTip:"Knusprig und lustig",workTip:"Frisch zubereiten"},
                    {name:"Spinat-Gorgonzola-Pasta",category:"Vegetarisch",price:17,ingredients:{"Penne":"500g","Spinat":"400g","Gorgonzola":"200g","Waln√ºsse":"100g","Sahne":"250ml"},instructions:["Nudeln kochen","Spinat anbraten","Gorgonzola schmelzen","Waln√ºsse r√∂sten","Alles mischen"],childTip:"Ohne Gorgonzola m√∂glich",workTip:"Mit Wasser aufw√§rmen"},
                    {name:"R√∂sti-Auflauf",category:"Vegetarisch",price:14,ingredients:{"Kartoffeln":"1,5kg","Zwiebeln":"2 St√ºck","K√§se":"300g","Sahne":"300ml","Lauch":"1 Stange"},instructions:["Kartoffeln raspeln","Schichten in Form","Mit Sahne √ºbergie√üen","Mit K√§se bedecken","45 Min backen"],childTip:"Goldbraun und k√§sig",workTip:"Super aufw√§rmbar"},
                    {name:"Tofu-Teriyaki",category:"Vegetarisch",price:15,ingredients:{"Tofu":"400g","Teriyaki-Sauce":"200ml","Reis":"400g","Brokkoli":"500g","Sesam":"2 EL"},instructions:["Tofu marinieren","Scharf anbraten","Brokkoli d√§mpfen","Mit Teriyaki glasieren","Mit Sesam bestreuen"],childTip:"S√º√ülich durch Sauce",workTip:"Gut aufw√§rmbar"},
                    {name:"K√ºrbis-Risotto",category:"Vegetarisch",price:16,ingredients:{"Hokkaido":"1 kleiner","Risottoreis":"400g","Wei√üwein":"200ml","Parmesan":"150g","Salbei":"1 Bund"},instructions:["K√ºrbis w√ºrfeln","Anbraten","Reis zugeben","Nach und nach Br√ºhe","Mit Salbei garnieren"],childTip:"Orange und cremig",workTip:"Mit Br√ºhe aufw√§rmen"},
                    {name:"Griechischer Bauernsalat",category:"Vegetarisch",price:14,ingredients:{"Feta":"400g","Tomaten":"6 St√ºck","Gurken":"2 St√ºck","Oliven":"200g","Fladenbrot":"4 St√ºck"},instructions:["Gem√ºse w√ºrfeln","Feta br√∂ckeln","Mit Oliven√∂l mischen","Mit Oregano w√ºrzen","Mit Fladenbrot servieren"],childTip:"Ohne Oliven f√ºr Kinder",workTip:"Als Meal-Prep ideal"},
                    {name:"Pilz-Stroganoff",category:"Vegetarisch",price:18,ingredients:{"Pilze gemischt":"600g","Zwiebeln":"2 St√ºck","Saure Sahne":"300ml","Reis":"400g","Petersilie":"1 Bund"},instructions:["Pilze anbraten","Zwiebeln zugeben","Mit Sahne abl√∂schen","W√ºrzen","Mit Reis servieren"],childTip:"Cremig und mild",workTip:"Gut aufw√§rmbar"},
                    {name:"Mozzarella-Tomaten-Tarte",category:"Vegetarisch",price:15,ingredients:{"Bl√§tterteig":"1 Rolle","Tomaten":"5 St√ºck","Mozzarella":"250g","Pesto":"100g","Rucola":"100g"},instructions:["Bl√§tterteig auslegen","Mit Pesto bestreichen","Tomaten und Mozzarella","25 Min backen","Mit Rucola garnieren"],childTip:"Wie Pizza",workTip:"Kalt auch gut"},
                    {name:"Linsen-Dal",category:"Vegetarisch",price:12,ingredients:{"Rote Linsen":"300g","Kokosmilch":"400ml","Tomaten":"3 St√ºck","Naan-Brot":"4 St√ºck","Koriander":"1 Bund"},instructions:["Linsen kochen","Tomaten zugeben","Mit Kokosmilch cremig","W√ºrzen","Mit Naan servieren"],childTip:"Sehr mild m√∂glich",workTip:"Perfekt aufw√§rmbar"},
                    {name:"Zucchini-Puffer",category:"Vegetarisch",price:11,ingredients:{"Zucchini":"3 gro√üe","Eier":"3 St√ºck","Mehl":"150g","K√§se":"150g","Tzatziki":"300g"},instructions:["Zucchini raspeln","Ausdr√ºcken","Mit Ei und Mehl mischen","Puffer braten","Mit Tzatziki servieren"],childTip:"Knusprig au√üen",workTip:"Auch kalt lecker"},
                    {name:"Champignon-Rahm-Geschnetzeltes",category:"Vegetarisch",price:16,ingredients:{"Champignons":"800g","Sahne":"400ml","Zwiebeln":"2 St√ºck","Sp√§tzle":"500g","Petersilie":"1 Bund"},instructions:["Pilze in Streifen","Scharf anbraten","Mit Sahne abl√∂schen","Sp√§tzle kochen","Zusammen servieren"],childTip:"Wie mit Fleisch",workTip:"Sehr gut aufw√§rmbar"},
                    {name:"Gem√ºse-Frittata",category:"Vegetarisch",price:13,ingredients:{"Eier":"8 St√ºck","Gem√ºse":"600g","K√§se":"200g","Milch":"200ml","Salat":"1 Kopf"},instructions:["Gem√ºse anbraten","Eier-Milch-Mix dr√ºber","Mit K√§se bestreuen","Im Ofen stocken","Mit Salat servieren"],childTip:"Buntes Omelett",workTip:"Kalt als Snack"},
                    {name:"Polenta mit Ratatouille",category:"Vegetarisch",price:14,ingredients:{"Polenta":"300g","Gem√ºse f√ºr Ratatouille":"800g","Tomaten":"400g","Parmesan":"150g","Kr√§uter":"gemischt"},instructions:["Polenta kochen","Ratatouille schmoren","Polenta in Form","Anbraten","Mit Ratatouille servieren"],childTip:"Mais-Brei mit Gem√ºse",workTip:"Gut aufw√§rmbar"},
                    {name:"Kartoffel-Gem√ºse-Gratin",category:"Vegetarisch",price:13,ingredients:{"Kartoffeln":"1kg","Brokkoli":"500g","Sahne":"400ml","K√§se":"250g","Muskat":"1 Prise"},instructions:["Kartoffeln schneiden","Mit Gem√ºse schichten","Sahne-K√§se-Mix dr√ºber","45 Min backen"],childTip:"K√§sig und cremig",workTip:"Perfekt aufw√§rmbar"}
                ],
                kids: [
                    {name:"Mini-Frikadellen",category:"Kinder",price:8,ingredients:{"Hackfleisch":"250g","Ei":"1 St√ºck","Semmelbr√∂sel":"3 EL","Kartoffelbrei":"500g"},instructions:["Hackfleisch mischen","Kleine Frikadellen formen","Braten","Mit Kartoffelbrei servieren"],childTip:"Sehr mild w√ºrzen",workTip:"Nur f√ºr Kinder"},
                    {name:"Pfannkuchen",category:"Kinder",price:6,ingredients:{"Mehl":"200g","Milch":"400ml","Eier":"3 St√ºck","Apfelmus":"400g"},instructions:["Teig anr√ºhren","D√ºnne Pfannkuchen backen","Mit Apfelmus servieren"],childTip:"Der Klassiker",workTip:"Nur f√ºr Kinder"},
                    {name:"Nudeln mit Butter",category:"Kinder",price:5,ingredients:{"Nudeln":"200g","Butter":"50g","Parmesan":"50g","Erbsen":"100g"},instructions:["Nudeln kochen","Mit Butter mischen","Parmesan dr√ºber"],childTip:"Einfach und beliebt",workTip:"Nur f√ºr Kinder"},
                    {name:"Pizza-Schnecken",category:"Kinder",price:8,ingredients:{"Pizzateig":"1 Rolle","Tomatensauce":"150ml","Salami":"100g","K√§se":"150g"},instructions:["Teig belegen","Aufrollen","In Scheiben schneiden","20 Min backen"],childTip:"Mini-Pizzen",workTip:"Nur f√ºr Kinder"},
                    {name:"Chicken Nuggets",category:"Kinder",price:10,ingredients:{"H√§hnchen":"300g","Cornflakes":"100g","Ei":"1 St√ºck","Pommes":"400g"},instructions:["H√§hnchen schneiden","In Cornflakes wenden","Backen","Mit Pommes servieren"],childTip:"Ges√ºnder als gekaufte",workTip:"Nur f√ºr Kinder"},
                    {name:"Kartoffelpuffer",category:"Kinder",price:7,ingredients:{"Kartoffeln":"600g","Ei":"1 St√ºck","Mehl":"2 EL","Apfelmus":"400g","√ñl":"zum Braten"},instructions:["Kartoffeln reiben","Mit Ei und Mehl mischen","Kleine Puffer braten","Mit Apfelmus servieren"],childTip:"Knusprig und s√º√ü",workTip:"Nur f√ºr Kinder"},
                    {name:"K√§se-Schinken-Toast",category:"Kinder",price:6,ingredients:{"Toastbrot":"8 Scheiben","Schinken":"150g","K√§se":"150g","Butter":"zum Bestreichen","Tomaten":"2 St√ºck"},instructions:["Toast buttern","Belegen","Toasten","In Dreiecke schneiden"],childTip:"Der Klassiker",workTip:"Nur f√ºr Kinder"},
                    {name:"H√ºhnersuppe",category:"Kinder",price:9,ingredients:{"H√ºhnerbr√ºhe":"1L","Suppennudeln":"100g","M√∂hren":"2 St√ºck","H√ºhnerfleisch":"150g","Petersilie":"1 Bund"},instructions:["Br√ºhe aufkochen","M√∂hren w√ºrfeln","Nudeln kochen","H√ºhnerfleisch zugeben","Mit Petersilie garnieren"],childTip:"Bei Erk√§ltung ideal",workTip:"Nur f√ºr Kinder"},
                    {name:"Grie√übrei",category:"Kinder",price:5,ingredients:{"Milch":"500ml","Grie√ü":"80g","Zucker":"2 EL","Zimt":"1 TL","Kompott":"200g"},instructions:["Milch aufkochen","Grie√ü einrieseln","R√ºhren und kochen","Mit Zimt bestreuen","Mit Kompott servieren"],childTip:"S√º√ües Mittagessen",workTip:"Nur f√ºr Kinder"},
                    {name:"W√ºrstchen im Schlafrock",category:"Kinder",price:8,ingredients:{"W√ºrstchen":"4 St√ºck","Bl√§tterteig":"1 Rolle","Ei":"1 St√ºck","Ketchup":"zum Dippen"},instructions:["Bl√§tterteig schneiden","W√ºrstchen einwickeln","Mit Ei bestreichen","15 Min backen","Mit Ketchup servieren"],childTip:"Fingerfood",workTip:"Nur f√ºr Kinder"},
                    {name:"Tomatensuppe",category:"Kinder",price:6,ingredients:{"Tomaten passiert":"500ml","Reis":"80g","Sahne":"100ml","Br√ºhe":"500ml","Basilikum":"einige Bl√§tter"},instructions:["Br√ºhe mit Tomaten aufkochen","Reis zugeben","15 Min k√∂cheln","Mit Sahne verfeinern","Mit Basilikum garnieren"],childTip:"Mild und s√§ttigend",workTip:"Nur f√ºr Kinder"},
                    {name:"Eierkuchen-R√∂llchen",category:"Kinder",price:7,ingredients:{"Eier":"3 St√ºck","Mehl":"150g","Milch":"250ml","Frischk√§se":"150g","Schinken":"100g"},instructions:["Eierkuchen backen","Mit Frischk√§se bestreichen","Schinken drauf","Aufrollen und schneiden"],childTip:"Fingerfood",workTip:"Nur f√ºr Kinder"},
                    {name:"Milchreis",category:"Kinder",price:6,ingredients:{"Milchreis":"200g","Milch":"800ml","Zucker":"3 EL","Obst":"300g","Zimt":"zum Bestreuen"},instructions:["Milch aufkochen","Reis zugeben","30 Min quellen","Obst schneiden","Mit Zimt servieren"],childTip:"S√º√ü und gesund",workTip:"Nur f√ºr Kinder"},
                    {name:"Mini-Hackb√§llchen",category:"Kinder",price:9,ingredients:{"Hackfleisch":"250g","Semmelbr√∂sel":"3 EL","Ei":"1 St√ºck","Tomatensauce":"400ml","Nudeln":"200g"},instructions:["Kleine B√§llchen formen","In Sauce k√∂cheln","Nudeln kochen","Zusammen servieren"],childTip:"Kleine B√§llchen sind praktisch",workTip:"Nur f√ºr Kinder"},
                    {name:"Gem√ºse-Muffins",category:"Kinder",price:7,ingredients:{"Mehl":"200g","Eier":"2 St√ºck","Milch":"150ml","Zucchini":"1 kleine","K√§se":"100g"},instructions:["Gem√ºse raspeln","Teig anr√ºhren","In Muffinformen","20 Min backen"],childTip:"Verstecktes Gem√ºse",workTip:"Nur f√ºr Kinder"},
                    {name:"Spaghetti mit Tomatensauce",category:"Kinder",price:5,ingredients:{"Spaghetti":"200g","Tomatensauce":"300ml","Parmesan":"50g","Basilikum":"einige Bl√§tter"},instructions:["Spaghetti kochen","Sauce erw√§rmen","Mischen","Mit Parmesan bestreuen"],childTip:"Der absolute Klassiker",workTip:"Nur f√ºr Kinder"},
                    {name:"Brotzeit-Teller",category:"Kinder",price:7,ingredients:{"Vollkornbrot":"4 Scheiben","K√§se":"100g","Wurst":"100g","Gem√ºsesticks":"200g"},instructions:["Brot in Dreiecke","Gem√ºse schneiden","Alles anrichten"],childTip:"Bunter Teller",workTip:"Nur f√ºr Kinder"},
                    {name:"Kaiserschmarrn",category:"Kinder",price:8,ingredients:{"Eier":"4 St√ºck","Mehl":"150g","Milch":"200ml","Rosinen":"50g","Puderzucker":"zum Best√§uben"},instructions:["Teig anr√ºhren","In Pfanne backen","Zerrei√üen","Mit Puderzucker best√§uben"],childTip:"S√º√ües Hauptgericht",workTip:"Nur f√ºr Kinder"},
                    {name:"Gem√ºse-Reis-Pfanne",category:"Kinder",price:7,ingredients:{"Reis":"200g","M√∂hren":"2 St√ºck","Erbsen":"150g","Mais":"150g","Ei":"2 St√ºck"},instructions:["Reis kochen","Gem√ºse anbraten","Reis untermischen","Ei unterr√ºhren"],childTip:"Buntes Essen",workTip:"Nur f√ºr Kinder"},
                    {name:"Fischst√§bchen",category:"Kinder",price:9,ingredients:{"Fischst√§bchen":"8 St√ºck","Kartoffelp√ºree":"500g","Erbsen":"200g","Remoulade":"100g"},instructions:["Fischst√§bchen backen","Kartoffelp√ºree zubereiten","Erbsen kochen","Zusammen servieren"],childTip:"Knusprig und mild",workTip:"Nur f√ºr Kinder"}
                ]
            };
        }

        // Globale Variablen
        let currentWeekPlan = [];
        let shoppingListData = {};
        let preferences = {};
        let weeksSincePizza = 0;
        let currentWeekStart = null;
        let savedWeeks = [];
        let currentGistId = null;

        // Initialisierung beim Laden
        window.addEventListener('DOMContentLoaded', function() {
            loadRecipes();
            loadPreferences();
            loadSavedWeeks();
            updateRecipeStats();
            calculateCurrentWeekDates();
            updatePizzaCountdown();
            generateNewPlan();
        });

        // Rezept-Statistiken aktualisieren
        function updateRecipeStats() {
            const meatCount = recipes.meat ? recipes.meat.length : 0;
            const vegCount = recipes.vegetarian ? recipes.vegetarian.length : 0;
            const kidsCount = recipes.kids ? recipes.kids.length : 0;
            const total = meatCount + vegCount + kidsCount;
            
            document.getElementById('totalRecipes').textContent = total;
            document.getElementById('meatCount').textContent = meatCount;
            document.getElementById('vegCount').textContent = vegCount;
            document.getElementById('kidsCount').textContent = kidsCount;
        }

        // Pizza Countdown aktualisieren
        function updatePizzaCountdown() {
            const pizzaFreq = document.getElementById('pizzaFrequency').value;
            if (pizzaFreq === '0') {
                document.getElementById('pizzaCountdown').textContent = 'deaktiviert';
            } else if (pizzaFreq === '3') {
                const nextPizza = Math.max(1, 3 - weeksSincePizza);
                document.getElementById('pizzaCountdown').textContent = `${nextPizza}`;
            } else {
                const nextPizza = Math.max(1, parseInt(pizzaFreq) - weeksSincePizza);
                document.getElementById('pizzaCountdown').textContent = `${nextPizza}`;
            }
        }

        // Tab-Wechsel Funktion
        function switchTab(event, tabName) {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // Wochendatum berechnen (Freitag bis Donnerstag)
        function calculateCurrentWeekDates() {
            const today = new Date();
            const dayOfWeek = today.getDay();
            
            let daysToLastFriday = (dayOfWeek + 2) % 7;
            if (dayOfWeek >= 5 || dayOfWeek === 0) {
                daysToLastFriday = (dayOfWeek === 5) ? 0 : (dayOfWeek === 6) ? 1 : 2;
            }
            
            currentWeekStart = new Date(today);
            currentWeekStart.setDate(today.getDate() - daysToLastFriday);
            currentWeekStart.setHours(0, 0, 0, 0);
            
            const weekEnd = new Date(currentWeekStart);
            weekEnd.setDate(currentWeekStart.getDate() + 6);
            
            const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
            const startStr = currentWeekStart.toLocaleDateString('de-CH', options);
            const endStr = weekEnd.toLocaleDateString('de-CH', options);
            
            document.getElementById('weekDateDisplay').textContent = `Woche vom ${startStr} bis ${endStr}`;
        }

        // Pr√§ferenzen laden
        function loadPreferences() {
            const saved = localStorage.getItem('mealPlannerPrefs');
            if (saved) {
                preferences = JSON.parse(saved);
                
                // Lade alle Einstellungen
                if (preferences.dailyBudget) document.getElementById('dailyBudget').value = preferences.dailyBudget;
                if (preferences.vegDays !== undefined) document.getElementById('vegDays').value = preferences.vegDays;
                if (preferences.adultsCount) document.getElementById('adultsCount').value = preferences.adultsCount;
                if (preferences.childrenCount) document.getElementById('childrenCount').value = preferences.childrenCount;
                if (preferences.weeksSincePizza !== undefined) {
                    weeksSincePizza = preferences.weeksSincePizza;
                }
                if (preferences.pizzaFrequency !== undefined) document.getElementById('pizzaFrequency').value = preferences.pizzaFrequency;
                if (preferences.githubToken) document.getElementById('githubToken').value = preferences.githubToken;
                
                // Lade Filtereinstellungen
                if (preferences.noLamb !== undefined) document.getElementById('noLamb').checked = preferences.noLamb;
                if (preferences.noPork !== undefined) document.getElementById('noPork').checked = preferences.noPork;
                if (preferences.noBeef !== undefined) document.getElementById('noBeef').checked = preferences.noBeef;
                if (preferences.noDuck !== undefined) document.getElementById('noDuck').checked = preferences.noDuck;
                if (preferences.noCottageCheese !== undefined) document.getElementById('noCottageCheese').checked = preferences.noCottageCheese;
                if (preferences.noGorgonzola !== undefined) document.getElementById('noGorgonzola').checked = preferences.noGorgonzola;
                if (preferences.noFeta !== undefined) document.getElementById('noFeta').checked = preferences.noFeta;
                if (preferences.noCheese !== undefined) document.getElementById('noCheese').checked = preferences.noCheese;
                if (preferences.noFish !== undefined) document.getElementById('noFish').checked = preferences.noFish;
                if (preferences.noMushrooms !== undefined) document.getElementById('noMushrooms').checked = preferences.noMushrooms;
                if (preferences.noNuts !== undefined) document.getElementById('noNuts').checked = preferences.noNuts;
                if (preferences.noSpicy !== undefined) document.getElementById('noSpicy').checked = preferences.noSpicy;
                if (preferences.noTofu !== undefined) document.getElementById('noTofu').checked = preferences.noTofu;
                if (preferences.noEggplant !== undefined) document.getElementById('noEggplant').checked = preferences.noEggplant;
            }
            updateBudgetDisplay();
        }

        // Gespeicherte Wochen laden
        function loadSavedWeeks() {
            const saved = localStorage.getItem('savedWeekPlans');
            if (saved) {
                savedWeeks = JSON.parse(saved);
            }
        }

        // Aktuelle Woche speichern
        function saveCurrentWeek() {
            if (currentWeekPlan.length === 0) {
                alert('‚ö† Kein Wochenplan zum Speichern vorhanden!');
                return;
            }
            
            const weekData = {
                id: Date.now(),
                weekStart: currentWeekStart.toISOString(),
                savedDate: new Date().toISOString(),
                weekPlan: currentWeekPlan,
                shoppingList: shoppingListData,
                totalCost: document.getElementById('totalCost').textContent,
                summary: getSummaryText()
            };
            
            if (savedWeeks.length >= 10) {
                if (confirm('‚ö†Ô∏è Es sind bereits 10 Wochen gespeichert. Die √§lteste Woche wird √ºberschrieben. Fortfahren?')) {
                    savedWeeks.shift();
                } else {
                    return;
                }
            }
            
            savedWeeks.push(weekData);
            localStorage.setItem('savedWeekPlans', JSON.stringify(savedWeeks));
            
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '‚úÖ Gespeichert!';
            btn.style.background = '#4CAF50';
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.style.background = '';
            }, 2000);
        }

        // Zusammenfassung erstellen
        function getSummaryText() {
            const meatCount = currentWeekPlan.filter(d => d.dinner.category === 'Fleisch').length;
            const vegCount = currentWeekPlan.filter(d => d.dinner.category === 'Vegetarisch').length;
            const pizzaCount = currentWeekPlan.filter(d => d.dinner.special === 'pizza-weekend').length;
            
            let summary = `${meatCount}x Fleisch, ${vegCount}x Vegetarisch`;
            if (pizzaCount > 0) {
                summary += `, ${pizzaCount}x Pizza`;
            }
            return summary;
        }

        // Gespeicherte Wochen anzeigen
        function showSavedWeeks() {
            if (savedWeeks.length === 0) {
                alert('üìÇ Keine gespeicherten Wochen vorhanden.');
                return;
            }
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>üìÇ Gespeicherte Wochen</h2>
                        <button class="close-modal" onclick="this.closest('.modal').remove()">√ó</button>
                    </div>
                    <div class="saved-weeks-list">
                        ${savedWeeks.map((week, index) => {
                            const weekStart = new Date(week.weekStart);
                            const weekEnd = new Date(weekStart);
                            weekEnd.setDate(weekStart.getDate() + 6);
                            const startStr = weekStart.toLocaleDateString('de-CH');
                            const endStr = weekEnd.toLocaleDateString('de-CH');
                            
                            return `
                                <div class="saved-week-item">
                                    <div class="saved-week-info">
                                        <div class="saved-week-date">${startStr} - ${endStr}</div>
                                        <div class="saved-week-summary">${week.summary} ‚Ä¢ ${week.totalCost} CHF</div>
                                    </div>
                                    <div class="saved-week-actions">
                                        <button class="mini-btn mini-btn-load" onclick="loadSavedWeek(${index})">Laden</button>
                                        <button class="mini-btn mini-btn-delete" onclick="deleteSavedWeek(${index})">üóëÔ∏è</button>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Gespeicherte Woche laden
        function loadSavedWeek(index) {
            const week = savedWeeks[index];
            
            if (currentWeekPlan.length > 0) {
                if (!confirm('‚ö†Ô∏è Der aktuelle Wochenplan wird √ºberschrieben. Fortfahren?')) {
                    return;
                }
            }
            
            currentWeekPlan = week.weekPlan;
            shoppingListData = week.shoppingList;
            currentWeekStart = new Date(week.weekStart);
            
            const weekEnd = new Date(currentWeekStart);
            weekEnd.setDate(currentWeekStart.getDate() + 6);
            const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
            const startStr = currentWeekStart.toLocaleDateString('de-CH', options);
            const endStr = weekEnd.toLocaleDateString('de-CH', options);
            document.getElementById('weekDateDisplay').textContent = `Woche vom ${startStr} bis ${endStr}`;
            
            displayWeekOverview();
            displayShoppingList();
            displayRecipes();
            
            document.querySelector('.modal').remove();
            
            alert('‚úÖ Wochenplan wurde geladen!');
        }

        // Gespeicherte Woche l√∂schen
        function deleteSavedWeek(index) {
            if (confirm('üóëÔ∏è Diese gespeicherte Woche wirklich l√∂schen?')) {
                savedWeeks.splice(index, 1);
                localStorage.setItem('savedWeekPlans', JSON.stringify(savedWeeks));
                
                document.querySelector('.modal').remove();
                showSavedWeeks();
            }
        }

        // Best√§tigung vor neuem Plan
        function confirmGenerateNewPlan() {
            if (currentWeekPlan.length > 0) {
                const confirmDialog = document.createElement('div');
                confirmDialog.className = 'confirm-dialog active';
                confirmDialog.innerHTML = `
                    <h3>‚ö†Ô∏è Neuen Plan generieren?</h3>
                    <p>Der aktuelle Wochenplan geht verloren, wenn er nicht gespeichert wurde.</p>
                    <p><strong>Tipp:</strong> Speichere den aktuellen Plan mit "Woche speichern" bevor du einen neuen generierst.</p>
                    <div class="confirm-actions">
                        <button class="btn btn-secondary" onclick="this.closest('.confirm-dialog').remove()">Abbrechen</button>
                        <button class="btn btn-primary" onclick="this.closest('.confirm-dialog').remove(); generateNewPlan();">Neuen Plan erstellen</button>
                    </div>
                `;
                document.body.appendChild(confirmDialog);
            } else {
                generateNewPlan();
            }
        }

        // Pr√§ferenzen speichern
        function savePreferences() {
            preferences = {
                dailyBudget: document.getElementById('dailyBudget').value,
                adultsCount: document.getElementById('adultsCount').value,
                childrenCount: document.getElementById('childrenCount').value,
                vegDays: document.getElementById('vegDays').value,
                pizzaFrequency: document.getElementById('pizzaFrequency').value,
                weeksSincePizza: weeksSincePizza,
                githubToken: document.getElementById('githubToken').value,
                // Speichere alle Filter
                noLamb: document.getElementById('noLamb').checked,
                noPork: document.getElementById('noPork').checked,
                noBeef: document.getElementById('noBeef').checked,
                noDuck: document.getElementById('noDuck').checked,
                noCottageCheese: document.getElementById('noCottageCheese').checked,
                noGorgonzola: document.getElementById('noGorgonzola').checked,
                noFeta: document.getElementById('noFeta').checked,
                noCheese: document.getElementById('noCheese').checked,
                noFish: document.getElementById('noFish').checked,
                noMushrooms: document.getElementById('noMushrooms').checked,
                noNuts: document.getElementById('noNuts').checked,
                noSpicy: document.getElementById('noSpicy').checked,
                noTofu: document.getElementById('noTofu').checked,
                noEggplant: document.getElementById('noEggplant').checked
            };
            localStorage.setItem('mealPlannerPrefs', JSON.stringify(preferences));
            alert('‚úÖ Einstellungen wurden gespeichert!');
        }

        // Budget-Anzeige aktualisieren
        function updateBudgetDisplay() {
            const dailyBudget = document.getElementById('dailyBudget').value;
            const weeklyBudget = dailyBudget * 7;
            document.getElementById('budgetDisplay').textContent = `${weeklyBudget} CHF`;
        }

        // Hilfsfunktion: Array mischen
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // Vegetarische Tage verteilen
        function distributeVegDays(totalDays, vegCount) {
            if (vegCount === 0) return [];
            if (vegCount >= totalDays) return Array.from({length: totalDays}, (_, i) => i);
            
            const positions = [];
            const spacing = Math.floor(totalDays / vegCount);
            
            for (let i = 0; i < vegCount; i++) {
                let pos = i * spacing + Math.floor(Math.random() * Math.max(1, spacing - 1));
                if (pos >= totalDays) pos = totalDays - 1;
                if (!positions.includes(pos)) {
                    positions.push(pos);
                }
            }
            
            return positions;
        }

        // Rezept filtern basierend auf Pr√§ferenzen
        function filterRecipe(recipe) {
            const prefs = preferences;
            const ingredients = Object.keys(recipe.ingredients).join(' ').toLowerCase();
            const name = recipe.name.toLowerCase();
            
            // Fleisch-Filter
            if (prefs.noLamb && (name.includes('lamm') || ingredients.includes('lamm'))) return false;
            if (prefs.noPork && (name.includes('schwein') || ingredients.includes('schwein') || 
                name.includes('speck') || ingredients.includes('speck') || 
                name.includes('schinken') || ingredients.includes('schinken'))) return false;
            if (prefs.noBeef && (name.includes('rind') || ingredients.includes('rind') || 
                name.includes('kalb') || ingredients.includes('kalb'))) return false;
            if (prefs.noDuck && (name.includes('ente') || ingredients.includes('ente'))) return false;
            
            // Milchprodukte-Filter
            if (prefs.noCottageCheese && (name.includes('h√ºttenk√§se') || ingredients.includes('h√ºttenk√§se'))) return false;
            if (prefs.noGorgonzola && (name.includes('gorgonzola') || ingredients.includes('gorgonzola'))) return false;
            if (prefs.noFeta && (name.includes('feta') || ingredients.includes('feta'))) return false;
            
            // Weitere Filter
            if (prefs.noFish && (name.includes('fisch') || ingredients.includes('fisch'))) return false;
            if (prefs.noMushrooms && (name.includes('pilz') || ingredients.includes('pilz') || 
                name.includes('champignon') || ingredients.includes('champignon'))) return false;
            if (prefs.noNuts && (name.includes('nuss') || ingredients.includes('nuss') || 
                name.includes('waln√ºsse') || ingredients.includes('waln√ºsse'))) return false;
            if (prefs.noSpicy && (name.includes('chili') || ingredients.includes('chili') || 
                name.includes('scharf') || recipe.childTip.includes('scharf'))) return false;
            if (prefs.noTofu && (name.includes('tofu') || ingredients.includes('tofu'))) return false;
            if (prefs.noEggplant && (name.includes('aubergine') || ingredients.includes('aubergine'))) return false;
            
            return true;
        }

        // Neuen Wochenplan generieren
        function generateNewPlan() {
            document.getElementById('loadingOverview').classList.add('active');
            
            setTimeout(() => {
                const vegDays = parseInt(document.getElementById('vegDays').value);
                const pizzaFreq = document.getElementById('pizzaFrequency').value;
                const days = ['Freitag', 'Samstag', 'Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag'];
                
                // Pizza-Wochenende Logik
                let isPizzaWeekend = false;
                if (pizzaFreq !== '0') {
                    weeksSincePizza++;
                    
                    if (pizzaFreq === '3') {
                        // 2-3 Wochen mit Zufall
                        isPizzaWeekend = weeksSincePizza >= 2 && (weeksSincePizza >= 3 || Math.random() > 0.5);
                    } else if (pizzaFreq === '4') {
                        // 3-4 Wochen mit Zufall
                        isPizzaWeekend = weeksSincePizza >= 3 && (weeksSincePizza >= 4 || Math.random() > 0.5);
                    } else {
                        // Feste Frequenz
                        isPizzaWeekend = weeksSincePizza >= parseInt(pizzaFreq);
                    }
                    
                    if (isPizzaWeekend) {
                        weeksSincePizza = 0;
                        // Pizza-Alert
                        setTimeout(() => {
                            document.getElementById('pizzaIndicator').style.display = 'block';
                            alert('üçï PIZZA-WOCHENENDE! üçï\n\nDiese Woche gibt es Freitag und Samstag Pizza!\n\nGenie√üt euer entspanntes Wochenende!');
                        }, 1000);
                    } else {
                        document.getElementById('pizzaIndicator').style.display = 'none';
                    }
                } else {
                    document.getElementById('pizzaIndicator').style.display = 'none';
                }
                
                // Rezepte filtern
                const filteredMeatRecipes = shuffleArray(recipes.meat.filter(r => filterRecipe(r)));
                const filteredVegRecipes = shuffleArray(recipes.vegetarian.filter(r => filterRecipe(r)));
                const filteredKidsRecipes = shuffleArray(recipes.kids.filter(r => filterRecipe(r)));
                
                // Pr√ºfen ob genug Rezepte vorhanden
                if (filteredMeatRecipes.length < 4 || filteredVegRecipes.length < 3) {
                    alert('‚ö†Ô∏è Warnung: Mit den aktuellen Filtereinstellungen sind nicht genug Rezepte verf√ºgbar. Bitte reduziere die Ausschl√ºsse in den Einstellungen.');
                }
                
                // Pizza-Rezepte definieren
                const pizzaFriday = {
                    name: "üçï Pizza-Freitag (Selbstgemacht)",
                    category: "Pizza-Weekend",
                    price: 7,
                    ingredients: {
                        "Pizzamehl (f√ºr 2 Tage)": "1kg",
                        "San Marzano Tomaten": "1 Dose",
                        "Galbani Mozzarella Cucina": "300g",
                        "Belag nach Wahl": "Salami oder Thunfisch",
                        "Oliven√∂l": "2 EL",
                        "Hefe": "1 W√ºrfel",
                        "Salz": "1 TL"
                    },
                    instructions: [
                        "Teig f√ºr 2 Tage vorbereiten (1kg Mehl)",
                        "24 Stunden im K√ºhlschrank gehen lassen",
                        "Teig portionieren und ausrollen",
                        "Mit San Marzano Tomatensauce bestreichen",
                        "Galbani Mozzarella und Belag verteilen",
                        "Bei 250¬∞C ca. 10-12 Min backen",
                        "Restlichen Teig f√ºr morgen aufbewahren"
                    ],
                    childTip: "Kinder k√∂nnen beim Belegen helfen",
                    workTip: "Reste kalt zum Mitnehmen",
                    special: "pizza-weekend"
                };
                
                const pizzaSaturday = {
                    name: "üçï Pizza-Samstag (Tag 2)",
                    category: "Pizza-Weekend",
                    price: 7,
                    ingredients: {
                        "Teig vom Vortag": "bereits vorbereitet",
                        "Restliche San Marzano Sauce": "vom Vortag",
                        "Galbani Mozzarella Cucina": "300g",
                        "Belag Variation": "z.B. Schinken, Pilze, Gem√ºse",
                        "Oregano": "nach Geschmack"
                    },
                    instructions: [
                        "Teig vom Vortag verwenden",
                        "Nochmal 30 Min bei Raumtemperatur ruhen lassen",
                        "Ausrollen und belegen",
                        "Heute andere Bel√§ge ausprobieren",
                        "Bei 250¬∞C ca. 10-12 Min backen",
                        "Gem√ºtlicher Pizza-Samstag!"
                    ],
                    childTip: "Kinder k√∂nnen eigene Mini-Pizzen machen",
                    workTip: "Perfektes Wochenend-Essen",
                    special: "pizza-weekend"
                };
                
                currentWeekPlan = [];
                shoppingListData = {};
                
                const vegDayPositions = distributeVegDays(7, vegDays);
                
                let meatIndex = 0;
                let vegIndex = 0;
                let kidsIndex = 0;
                
                days.forEach((day, index) => {
                    let recipe;
                    
                    // Pizza-Wochenende √ºberschreibt normale Planung
                    if (isPizzaWeekend && day === 'Freitag') {
                        recipe = pizzaFriday;
                    } else if (isPizzaWeekend && day === 'Samstag') {
                        recipe = pizzaSaturday;
                    } else if (vegDayPositions.includes(index)) {
                        recipe = filteredVegRecipes[vegIndex++ % filteredVegRecipes.length];
                    } else {
                        recipe = filteredMeatRecipes[meatIndex++ % filteredMeatRecipes.length];
                    }
                    
                    const dayPlan = {
                        day: day,
                        dinner: recipe,
                        kidsLunch: null
                    };
                    
                    if (day === 'Dienstag' || day === 'Donnerstag') {
                        dayPlan.kidsLunch = filteredKidsRecipes[kidsIndex++ % filteredKidsRecipes.length];
                    }
                    
                    currentWeekPlan.push(dayPlan);
                    
                    addToShoppingList(recipe);
                    if (dayPlan.kidsLunch) {
                        addToShoppingList(dayPlan.kidsLunch);
                    }
                });
                
                // Speichere Pizza-Counter
                preferences.weeksSincePizza = weeksSincePizza;
                localStorage.setItem('mealPlannerPrefs', JSON.stringify(preferences));
                
                updatePizzaCountdown();
                displayWeekOverview();
                displayShoppingList();
                displayRecipes();
                
                document.getElementById('loadingOverview').classList.remove('active');
            }, 800);
        }

        // Zur Einkaufsliste hinzuf√ºgen
        function addToShoppingList(recipe) {
            for (const [ingredient, amount] of Object.entries(recipe.ingredients)) {
                if (!shoppingListData[ingredient]) {
                    shoppingListData[ingredient] = amount;
                } else {
                    shoppingListData[ingredient] += `, ${amount}`;
                }
            }
        }

        // Aus Einkaufsliste entfernen
        function removeFromShoppingList(recipe) {
            rebuildShoppingList();
        }
        
        // Einkaufsliste neu aufbauen
        function rebuildShoppingList() {
            shoppingListData = {};
            currentWeekPlan.forEach(dayPlan => {
                addToShoppingList(dayPlan.dinner);
                if (dayPlan.kidsLunch) {
                    addToShoppingList(dayPlan.kidsLunch);
                }
            });
        }

        // Wochen√ºbersicht anzeigen
        function displayWeekOverview() {
            const container = document.getElementById('weekOverview');
            container.innerHTML = '';
            let totalCost = 0;
            
            currentWeekPlan.forEach((dayPlan, index) => {
                let dayCost = dayPlan.dinner.price;
                if (dayPlan.kidsLunch) {
                    dayCost += dayPlan.kidsLunch.price;
                }
                totalCost += dayCost;
                
                const dayDate = new Date(currentWeekStart);
                dayDate.setDate(currentWeekStart.getDate() + index);
                const dateStr = dayDate.toLocaleDateString('de-CH', { day: '2-digit', month: '2-digit' });
                
                const dayCard = document.createElement('div');
                dayCard.className = 'day-card';
                if (dayPlan.dinner.special === 'pizza-weekend') {
                    dayCard.className += ' pizza-day';
                }
                
                dayCard.innerHTML = `
                    ${dayPlan.dinner.special !== 'pizza-weekend' ? 
                        `<button class="swap-btn" onclick="swapRecipe(${index}, 'dinner')" title="Rezept tauschen">üîÑ</button>` : ''}
                    <div class="day-header">
                        <span class="day-name">${dayPlan.day} <small style="color:#999;">${dateStr}</small></span>
                        <span class="price-tag">${dayCost} CHF</span>
                    </div>
                    <div class="meal-info">
                        <div class="meal-name">üçΩÔ∏è Abendessen: ${dayPlan.dinner.name}</div>
                        <div class="meal-details">${dayPlan.dinner.category} ‚Ä¢ ${dayPlan.dinner.workTip}</div>
                    </div>
                    ${dayPlan.kidsLunch ? `
                        <div class="meal-info" style="position:relative;">
                            <button class="swap-btn" onclick="swapRecipe(${index}, 'kidsLunch')" title="Kinder-Rezept tauschen" style="position:absolute; right:-5px; top:-5px; width:30px; height:30px; font-size:14px;">üîÑ</button>
                            <div class="meal-name">üë∂ Kinder-Mittag: ${dayPlan.kidsLunch.name}</div>
                            <div class="meal-details">Speziell f√ºr die Kleinen</div>
                        </div>
                    ` : ''}
                `;
                container.appendChild(dayCard);
            });
            
            document.getElementById('totalCost').textContent = totalCost.toFixed(2);
        }
        
        // Einzelnes Rezept austauschen
        function swapRecipe(dayIndex, mealType) {
            const dayPlan = currentWeekPlan[dayIndex];
            let availableRecipes = [];
            let currentRecipe = null;
            
            if (mealType === 'dinner') {
                currentRecipe = dayPlan.dinner;
                if (currentRecipe.category === 'Fleisch') {
                    availableRecipes = recipes.meat.filter(r => r.name !== currentRecipe.name && filterRecipe(r));
                } else if (currentRecipe.category === 'Vegetarisch') {
                    availableRecipes = recipes.vegetarian.filter(r => r.name !== currentRecipe.name && filterRecipe(r));
                }
            } else if (mealType === 'kidsLunch') {
                currentRecipe = dayPlan.kidsLunch;
                availableRecipes = recipes.kids.filter(r => r.name !== currentRecipe.name && filterRecipe(r));
            }
            
            if (availableRecipes.length > 0) {
                const newRecipe = availableRecipes[Math.floor(Math.random() * availableRecipes.length)];
                
                removeFromShoppingList(currentRecipe);
                
                if (mealType === 'dinner') {
                    currentWeekPlan[dayIndex].dinner = newRecipe;
                } else {
                    currentWeekPlan[dayIndex].kidsLunch = newRecipe;
                }
                
                addToShoppingList(newRecipe);
                
                displayWeekOverview();
                displayShoppingList();
                displayRecipes();
                
                const dayCards = document.querySelectorAll('.day-card');
                dayCards[dayIndex].style.animation = 'pulse 0.5s';
                setTimeout(() => {
                    dayCards[dayIndex].style.animation = '';
                }, 500);
                
                // Auto-Save nach Rezepttausch
                triggerAutoSave();
            } else {
                alert('‚ö†Ô∏è Keine alternativen Rezepte mit den aktuellen Filtereinstellungen verf√ºgbar.');
            }
        }

        // Einkaufsliste anzeigen
        function displayShoppingList() {
            const container = document.getElementById('shoppingList');
            container.innerHTML = '';
            
            const categories = {
                'ü•© Fleisch & Gefl√ºgel': [],
                'ü•ï Gem√ºse & Obst': [],
                'üßÄ Milchprodukte': [],
                'üçù Nudeln, Reis & Beilagen': [],
                'ü•´ Konserven & Haltbares': [],
                'üßÇ Gew√ºrze & √ñle': []
            };
            
            for (const [ingredient, amount] of Object.entries(shoppingListData)) {
                const lower = ingredient.toLowerCase();
                
                if (lower.includes('fleisch') || lower.includes('h√§hnchen') || 
                    lower.includes('schwein') || lower.includes('rind') || 
                    lower.includes('hack') || lower.includes('schnitzel') ||
                    lower.includes('lamm') || lower.includes('kalb') ||
                    lower.includes('ente') || lower.includes('pute')) {
                    categories['ü•© Fleisch & Gefl√ºgel'].push({ingredient, amount});
                } else if (lower.includes('milch') || lower.includes('k√§se') || 
                           lower.includes('sahne') || lower.includes('butter') ||
                           lower.includes('joghurt') || lower.includes('mozzarella') ||
                           lower.includes('ricotta') || lower.includes('feta')) {
                    categories['üßÄ Milchprodukte'].push({ingredient, amount});
                } else if (lower.includes('nudel') || lower.includes('reis') || 
                           lower.includes('spaghetti') || lower.includes('penne') ||
                           lower.includes('kartoffel') || lower.includes('sp√§tzle') ||
                           lower.includes('gnocchi') || lower.includes('couscous')) {
                    categories['üçù Nudeln, Reis & Beilagen'].push({ingredient, amount});
                } else if (lower.includes('dose') || lower.includes('bohnen')) {
                    categories['ü•´ Konserven & Haltbares'].push({ingredient, amount});
                } else if (lower.includes('salz') || lower.includes('pfeffer') ||
                           lower.includes('√∂l') || lower.includes('gew√ºrz')) {
                    categories['üßÇ Gew√ºrze & √ñle'].push({ingredient, amount});
                } else {
                    categories['ü•ï Gem√ºse & Obst'].push({ingredient, amount});
                }
            }
            
            for (const [category, items] of Object.entries(categories)) {
                if (items.length === 0) continue;
                
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'shopping-category';
                categoryDiv.innerHTML = `<h3>${category}</h3>`;
                
                items.forEach(item => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'shopping-item';
                    itemDiv.innerHTML = `
                        <input type="checkbox">
                        <span>${item.ingredient}: ${item.amount}</span>
                    `;
                    categoryDiv.appendChild(itemDiv);
                });
                
                container.appendChild(categoryDiv);
            }
        }

        // Rezepte anzeigen
        function displayRecipes() {
            const container = document.getElementById('recipesList');
            container.innerHTML = '';
            
            currentWeekPlan.forEach(dayPlan => {
                const recipeDiv = document.createElement('div');
                recipeDiv.className = 'recipe-details';
                recipeDiv.innerHTML = `
                    <h3>üçΩÔ∏è ${dayPlan.day} - ${dayPlan.dinner.name}</h3>
                    <div class="ingredients-list">
                        <h4>Zutaten (f√ºr 4,5 Portionen):</h4>
                        <ul>
                            ${Object.entries(dayPlan.dinner.ingredients).map(([ing, amount]) => 
                                `<li>${ing}: ${amount}</li>`
                            ).join('')}
                        </ul>
                    </div>
                    <div class="instructions">
                        <h4>Zubereitung:</h4>
                        <ol>
                            ${dayPlan.dinner.instructions.map(step => 
                                `<li>${step}</li>`
                            ).join('')}
                        </ol>
                    </div>
                    <div class="tips-box">
                        <h4>üí° Tipps:</h4>
                        <p><strong>F√ºr Kinder:</strong> ${dayPlan.dinner.childTip}</p>
                        <p><strong>F√ºrs B√ºro:</strong> ${dayPlan.dinner.workTip}</p>
                    </div>
                `;
                container.appendChild(recipeDiv);
                
                if (dayPlan.kidsLunch) {
                    const kidsDiv = document.createElement('div');
                    kidsDiv.className = 'recipe-details';
                    kidsDiv.innerHTML = `
                        <h3>üë∂ ${dayPlan.day} Mittag - ${dayPlan.kidsLunch.name}</h3>
                        <div class="ingredients-list">
                            <h4>Zutaten (f√ºr 2 Kinder):</h4>
                            <ul>
                                ${Object.entries(dayPlan.kidsLunch.ingredients).map(([ing, amount]) => 
                                    `<li>${ing}: ${amount}</li>`
                                ).join('')}
                            </ul>
                        </div>
                        <div class="instructions">
                            <h4>Zubereitung:</h4>
                            <ol>
                                ${dayPlan.kidsLunch.instructions.map(step => 
                                    `<li>${step}</li>`
                                ).join('')}
                            </ol>
                        </div>
                        <div class="tips-box">
                            <h4>üí° Tipp:</h4>
                            <p>${dayPlan.kidsLunch.childTip}</p>
                        </div>
                    `;
                    container.appendChild(kidsDiv);
                }
            });
        }

        // PDF Export
        function exportToPDF() {
            window.print();
        }

        // ========== GITHUB SYNC FUNKTIONEN ==========
        
        // GitHub Sync Dialog anzeigen
        function showGitHubSync() {
            const modal = document.getElementById('githubModal');
            modal.classList.add('active');
        }
        
        // GitHub Sync Dialog schlie√üen
        function closeGitHubSync() {
            const modal = document.getElementById('githubModal');
            modal.classList.remove('active');
        }
        
        // Wochenplan auf GitHub speichern
        async function saveToGitHub() {
            const token = document.getElementById('githubToken').value;
            const gistName = document.getElementById('gistName').value || `Wochenplan ${new Date().toLocaleDateString('de-CH')}`;
            
            if (!token) {
                document.getElementById('saveStatus').innerHTML = 
                    '<div class="status-error">‚ö†Ô∏è Bitte GitHub Token in den Einstellungen eingeben!</div>';
                return;
            }
            
            if (currentWeekPlan.length === 0) {
                document.getElementById('saveStatus').innerHTML = 
                    '<div class="status-error">‚ö†Ô∏è Kein Wochenplan zum Speichern vorhanden!</div>';
                return;
            }
            
            const data = {
                version: '2.0',
                timestamp: new Date().toISOString(),
                weekPlan: currentWeekPlan,
                shoppingList: shoppingListData,
                preferences: preferences,
                weeksSincePizza: weeksSincePizza,
                weekStart: currentWeekStart.toISOString(),
                totalCost: document.getElementById('totalCost').textContent
            };
            
            const gistData = {
                description: gistName,
                public: false,
                files: {
                    'wochenplan.json': {
                        content: JSON.stringify(data, null, 2)
                    }
                }
            };
            
            try {
                document.getElementById('saveStatus').innerHTML = 
                    '<div class="status-info">üîÑ Aktualisiere Gist...</div>';
                
                const response = await fetch(`https://api.github.com/gists/${currentGistId}`, {
                    method: 'PATCH',
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(gistData)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    
                    document.getElementById('saveStatus').innerHTML = 
                        '<div class="status-success">' +
                        '‚úÖ Erfolgreich aktualisiert!<br>' +
                        '<a href="' + result.html_url + '" target="_blank" style="color: #0366d6;">Auf GitHub ansehen ‚Üí</a>' +
                        '</div>';
                } else {
                    throw new Error('GitHub API Fehler: ' + response.status);
                }
            } catch (error) {
                document.getElementById('saveStatus').innerHTML = 
                    '<div class="status-error">‚ùå Fehler: ' + error.message + '</div>';
            }
        }
        
        // Gists laden und anzeigen
        async function loadGists() {
            const token = document.getElementById('githubToken').value;
            
            if (!token) {
                document.getElementById('loadStatus').innerHTML = 
                    '<div class="status-error">‚ö†Ô∏è Bitte GitHub Token in den Einstellungen eingeben!</div>';
                return;
            }
            
            try {
                document.getElementById('loadStatus').innerHTML = 
                    '<div class="status-info">üìã Lade Gists...</div>';
                
                const response = await fetch('https://api.github.com/gists', {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const gists = await response.json();
                    const mealPlanGists = gists.filter(gist => 
                        gist.files && gist.files['wochenplan.json']
                    );
                    
                    if (mealPlanGists.length === 0) {
                        document.getElementById('loadStatus').innerHTML = 
                            '<div class="status-info">Keine gespeicherten Wochenpl√§ne gefunden.</div>';
                        return;
                    }
                    
                    const gistList = document.getElementById('gistList');
                    gistList.innerHTML = mealPlanGists.map(gist => `
                        <div class="gist-item" onclick="loadGistById('${gist.id}')">
                            <div class="gist-title">${gist.description || 'Wochenplan'}</div>
                            <div class="gist-date">
                                ${new Date(gist.updated_at).toLocaleDateString('de-CH')} 
                                ${new Date(gist.updated_at).toLocaleTimeString('de-CH', {hour: '2-digit', minute: '2-digit'})}
                            </div>
                        </div>
                    `).join('');
                    
                    gistList.style.display = 'block';
                    document.getElementById('loadStatus').innerHTML = '';
                } else {
                    throw new Error(`GitHub API Fehler: ${response.status}`);
                }
            } catch (error) {
                document.getElementById('loadStatus').innerHTML = 
                    `<div class="status-error">‚ùå Fehler: ${error.message}</div>`;
            }
        }
        
        // Gist nach ID laden
        async function loadGistById(gistId) {
            const token = document.getElementById('githubToken').value;
            
            try {
                document.getElementById('loadStatus').innerHTML = 
                    '<div class="status-info">üì• Lade Wochenplan...</div>';
                
                const response = await fetch(`https://api.github.com/gists/${gistId}`, {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const gist = await response.json();
                    const content = gist.files['wochenplan.json'].content;
                    const data = JSON.parse(content);
                    
                    importWeekPlan(data);
                    currentGistId = gistId;
                    
                    document.getElementById('loadStatus').innerHTML = 
                        '<div class="status-success">‚úÖ Wochenplan erfolgreich geladen!</div>';
                    
                    setTimeout(() => {
                        closeGitHubSync();
                    }, 2000);
                } else {
                    throw new Error(`GitHub API Fehler: ${response.status}`);
                }
            } catch (error) {
                document.getElementById('loadStatus').innerHTML = 
                    `<div class="status-error">‚ùå Fehler: ${error.message}</div>`;
            }
        }
        
        // Von GitHub laden mit ID/URL
        async function loadFromGitHub() {
            const input = document.getElementById('gistId').value.trim();
            const token = document.getElementById('githubToken').value;
            
            if (!input) {
                document.getElementById('loadStatus').innerHTML = 
                    '<div class="status-error">‚ö†Ô∏è Bitte Gist-ID oder URL eingeben!</div>';
                return;
            }
            
            if (!token) {
                document.getElementById('loadStatus').innerHTML = 
                    '<div class="status-error">‚ö†Ô∏è Bitte GitHub Token in den Einstellungen eingeben!</div>';
                return;
            }
            
            // Extract Gist ID from URL if necessary
            let gistId = input;
            if (input.includes('gist.github.com')) {
                const matches = input.match(/([a-f0-9]{32})/);
                if (matches) {
                    gistId = matches[1];
                }
            }
            
            loadGistById(gistId);
        }
        
        // Wochenplan importieren
        function importWeekPlan(data) {
            if (!data.weekPlan || !data.version) {
                throw new Error('Ung√ºltiges Datenformat');
            }
            
            currentWeekPlan = data.weekPlan;
            shoppingListData = data.shoppingList || {};
            
            if (data.preferences) {
                preferences = { ...preferences, ...data.preferences };
                if (data.weeksSincePizza !== undefined) {
                    weeksSincePizza = data.weeksSincePizza;
                }
            }
            
            if (data.weekStart) {
                currentWeekStart = new Date(data.weekStart);
                const weekEnd = new Date(currentWeekStart);
                weekEnd.setDate(currentWeekStart.getDate() + 6);
                const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
                const startStr = currentWeekStart.toLocaleDateString('de-CH', options);
                const endStr = weekEnd.toLocaleDateString('de-CH', options);
                document.getElementById('weekDateDisplay').textContent = `Woche vom ${startStr} bis ${endStr}`;
            }
            
            updatePizzaCountdown();
            displayWeekOverview();
            displayShoppingList();
            displayRecipes();
            
            // Pizza-Wochenende Indikator pr√ºfen
            const hasPizza = currentWeekPlan.some(day => day.dinner.special === 'pizza-weekend');
            document.getElementById('pizzaIndicator').style.display = hasPizza ? 'block' : 'none';
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const githubModal = document.getElementById('githubModal');
            if (event.target === githubModal) {
                closeGitHubSync();
            }
        }
    </script>
</body>
</html>
                document.getElementById('saveStatus').innerHTML = 
                    '<div class="status-info">üì§ Speichere auf GitHub...</div>';
                
                const response = await fetch('https://api.github.com/gists', {
                    method: 'POST',
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(gistData)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    currentGistId = result.id;
                    
                    document.getElementById('saveStatus').innerHTML = 
                        `<div class="status-success">
                            ‚úÖ Erfolgreich gespeichert!<br>
                            Gist ID: <code>${result.id}</code><br>
                            <a href="${result.html_url}" target="_blank" style="color: #0366d6;">Auf GitHub ansehen ‚Üí</a>
                        </div>`;
                } else {
                    throw new Error(`GitHub API Fehler: ${response.status}`);
                }
            } catch (error) {
                document.getElementById('saveStatus').innerHTML = 
                    `<div class="status-error">‚ùå Fehler: ${error.message}</div>`;
            }
        }
        
        // Bestehenden Gist aktualisieren
        async function updateExistingGist() {
            const token = document.getElementById('githubToken').value;
            
            if (!token) {
                document.getElementById('saveStatus').innerHTML = 
                    '<div class="status-error">‚ö†Ô∏è Bitte GitHub Token in den Einstellungen eingeben!</div>';
                return;
            }
            
            if (!currentGistId) {
                const gistId = prompt('Bitte Gist-ID eingeben:');
                if (!gistId) return;
                currentGistId = gistId;
            }
            
            const data = {
                version: '2.0',
                timestamp: new Date().toISOString(),
                weekPlan: currentWeekPlan,
                shoppingList: shoppingListData,
                preferences: preferences,
                weeksSincePizza: weeksSincePizza,
                weekStart: currentWeekStart.toISOString(),
                totalCost: document.getElementById('totalCost').textContent
            };
            
            const gistData = {
                files: {
                    'wochenplan.json': {
                        content: JSON.stringify(data, null, 2)
                    }
                }
            };
            
            try {
